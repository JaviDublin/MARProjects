-- =============================================
-- Author:		Javier
-- Create date: June 2012
-- Description:	
-- =============================================
CREATE PROCEDURE [Import].[Insert_Fleet_Summary_History] 
AS
BEGIN
	
	SET NOCOUNT ON;
	
	DECLARE @REP_DATE DATETIME
	
	SET @REP_DATE = (SELECT MIN(REP_DATE) FROM FLEET_EUROPE_SUMMARY)
	
	DELETE FROM FLEET_EUROPE_SUMMARY_HISTORY WHERE REP_DATE = @REP_DATE
	
	INSERT INTO FLEET_EUROPE_SUMMARY_HISTORY
	(REP_YEAR,
	REP_MONTH,
	REP_WEEK_OF_YEAR,
	REP_DAY_OF_WEEK,
	REP_DATE,
	COUNTRY,
	LOCATION,
	CAR_GROUP,
	FLEET_RAC_TTL,
	FLEET_RAC_OPS,
	FLEET_CARSALES,
	FLEET_LICENSEE,
	TOTAL_FLEET,
	CARSALES,
	CARHOLD_H,
	CARHOLD_L,
	CU,
	HA,
	HL,
	LL,
	NC,
	PL,
	TC,
	SV,
	WS,
	WS_NONRAC,
	OPERATIONAL_FLEET,
	BD,
	MM,
	TW,
	TB,
	WS_RAC,
	AVAILABLE_TB,
	FS,
	RL,
	RP,
	TN,
	AVAILABLE_FLEET,
	RT,
	SU,
	GOLD,
	PREDELIVERY,
	OVERDUE,
	ON_RENT,
	TOTAL_FLEET_MIN,
	CARSALES_MIN,
	CARHOLD_H_MIN,
	CARHOLD_L_MIN,
	CU_MIN,
	HA_MIN,
	HL_MIN,
	LL_MIN,
	NC_MIN,
	PL_MIN,
	TC_MIN,
	SV_MIN,
	WS_MIN,
	WS_NONRAC_MIN,
	OPERATIONAL_FLEET_MIN,
	BD_MIN,
	MM_MIN,
	TW_MIN,
	TB_MIN,
	WS_RAC_MIN,
	AVAILABLE_TB_MIN,
	FS_MIN,
	RL_MIN,
	RP_MIN,
	TN_MIN,
	AVAILABLE_FLEET_MIN,
	RT_MIN,
	SU_MIN,
	GOLD_MIN,
	PREDELIVERY_MIN,
	OVERDUE_MIN,
	ON_RENT_MIN,
	TOTAL_FLEET_MAX,
	CARSALES_MAX,
	CARHOLD_H_MAX,
	CARHOLD_L_MAX,
	CU_MAX,
	HA_MAX,
	HL_MAX,
	LL_MAX,
	NC_MAX,
	PL_MAX,
	TC_MAX,
	SV_MAX,
	WS_MAX,
	WS_NONRAC_MAX,
	OPERATIONAL_FLEET_MAX,
	BD_MAX,
	MM_MAX,
	TW_MAX,
	TB_MAX,
	WS_RAC_MAX,
	AVAILABLE_TB_MAX,
	FS_MAX,
	RL_MAX,
	RP_MAX,
	TN_MAX,
	AVAILABLE_FLEET_MAX,
	RT_MAX,
	SU_MAX,
	GOLD_MAX,
	PREDELIVERY_MAX,
	OVERDUE_MAX,
	ON_RENT_MAX,
	TOTAL_FLEET_MAX_ABSOLUTE,
	OPERATIONAL_FLEET_MAX_ABSOLUTE,
	OVERDUE_MAX_ABSOLUTE,
	ON_RENT_MAX_ABSOLUTE,
	FLEET_ADV,
	FLEET_HOD)

	
	

	SELECT 
		REP_YEAR,
		REP_MONTH,
		REP_WEEK_OF_YEAR,
		REP_DAY_OF_WEEK,
		REP_DATE,
		COUNTRY,
		LOCATION,
		CAR_GROUP,
		FLEET_RAC_TTL,
		FLEET_RAC_OPS,
		FLEET_CARSALES,
		FLEET_LICENSEE,
		TOTAL_FLEET,
		CARSALES,
		CARHOLD_H,
		CARHOLD_L,
		CU,
		HA,
		HL,
		LL,
		NC,
		PL,
		TC,
		SV,
		WS,
		WS_NONRAC,
		OPERATIONAL_FLEET,
		BD,
		MM,
		TW,
		TB,
		WS_RAC,
		AVAILABLE_TB,
		FS,
		RL,
		RP,
		TN,
		AVAILABLE_FLEET,
		RT,
		SU,
		GOLD,
		PREDELIVERY,
		OVERDUE,
		ON_RENT,
		TOTAL_FLEET_MIN,
		CARSALES_MIN,
		CARHOLD_H_MIN,
		CARHOLD_L_MIN,
		CU_MIN,
		HA_MIN,
		HL_MIN,
		LL_MIN,
		NC_MIN,
		PL_MIN,
		TC_MIN,
		SV_MIN,
		WS_MIN,
		WS_NONRAC_MIN,
		OPERATIONAL_FLEET_MIN,
		BD_MIN,
		MM_MIN,
		TW_MIN,
		TB_MIN,
		WS_RAC_MIN,
		AVAILABLE_TB_MIN,
		FS_MIN,
		RL_MIN,
		RP_MIN,
		TN_MIN,
		AVAILABLE_FLEET_MIN,
		RT_MIN,
		SU_MIN,
		GOLD_MIN,
		PREDELIVERY_MIN,
		OVERDUE_MIN,
		ON_RENT_MIN,
		TOTAL_FLEET_MAX,
		CARSALES_MAX,
		CARHOLD_H_MAX,
		CARHOLD_L_MAX,
		CU_MAX,
		HA_MAX,
		HL_MAX,
		LL_MAX,
		NC_MAX,
		PL_MAX,
		TC_MAX,
		SV_MAX,
		WS_MAX,
		WS_NONRAC_MAX,
		OPERATIONAL_FLEET_MAX,
		BD_MAX,
		MM_MAX,
		TW_MAX,
		TB_MAX,
		WS_RAC_MAX,
		AVAILABLE_TB_MAX,
		FS_MAX,
		RL_MAX,
		RP_MAX,
		TN_MAX,
		AVAILABLE_FLEET_MAX,
		RT_MAX,
		SU_MAX,
		GOLD_MAX,
		PREDELIVERY_MAX,
		OVERDUE_MAX,
		ON_RENT_MAX,
		TOTAL_FLEET_MAX_ABSOLUTE,
		OPERATIONAL_FLEET_MAX_ABSOLUTE,
		OVERDUE_MAX_ABSOLUTE,
		ON_RENT_MAX_ABSOLUTE,
		FLEET_ADV,
		FLEET_HOD
	FROM 
		FLEET_EUROPE_SUMMARY 
	WHERE 
		REP_DATE = @REP_DATE
    
END