-- =============================================
-- Author:		Javier
-- Create date: June 2012
-- Description:	
-- =============================================
create PROCEDURE [Import].[Insert_Fleet_Summary_History_Daily] 
@Type varchar(20)
AS
BEGIN
	
	SET NOCOUNT ON;
	
if @Type = 'Daily'
begin	
	DECLARE @REP_DATE DATETIME
	
	SET @REP_DATE = (SELECT MIN(REP_DATE) FROM FLEET_EUROPE_SUMMARY)
	
	DELETE FROM FLEET_EUROPE_SUMMARY_HISTORY WHERE REP_DATE = @REP_DATE
	
	INSERT INTO FLEET_EUROPE_SUMMARY_HISTORY
	SELECT * FROM FLEET_EUROPE_SUMMARY WHERE REP_DATE = @REP_DATE
end
	--MERGE FLEET_EUROPE_SUMMARY_HISTORY AS TARGET
	--USING FLEET_EUROPE_SUMMARY AS SOURCE
	--ON
	--(
	--	TARGET.REP_DATE			= SOURCE.REP_DATE		AND
	--	TARGET.COUNTRY			= SOURCE.COUNTRY		AND
	--	TARGET.LOCATION			= SOURCE.LOCATION		AND
	--	TARGET.CAR_GROUP		= SOURCE.CAR_GROUP		AND
	--	TARGET.FLEET_RAC_TTL	= SOURCE.FLEET_RAC_TTL	AND
	--	TARGET.FLEET_RAC_OPS	= SOURCE.FLEET_RAC_OPS	AND
	--	TARGET.FLEET_CARSALES	= SOURCE.FLEET_CARSALES	AND
	--	TARGET.FLEET_LICENSEE	= SOURCE.FLEET_LICENSEE
	--)
	--WHEN MATCHED THEN
	--	UPDATE SET
	--		TARGET.TOTAL_FLEET						= SOURCE.TOTAL_FLEET, 
	--		TARGET.CARSALES							= SOURCE.CARSALES, 
	--		TARGET.CARHOLD_H						= SOURCE.CARHOLD_H, 
	--		TARGET.CARHOLD_L						= SOURCE.CARHOLD_L, 
	--		TARGET.CU								= SOURCE.CU, 
	--		TARGET.HA								= SOURCE.HA, 
	--		TARGET.HL								= SOURCE.HL, 
	--		TARGET.LL								= SOURCE.LL, 
	--		TARGET.NC								= SOURCE.NC, 
	--		TARGET.PL								= SOURCE.PL, 
	--		TARGET.TC								= SOURCE.TC,
	--		TARGET.SV								= SOURCE.SV, 
	--		TARGET.WS								= SOURCE.WS, 
	--		TARGET.WS_NONRAC						= SOURCE.WS_NONRAC, 
	--		TARGET.OPERATIONAL_FLEET				= SOURCE.OPERATIONAL_FLEET, 
	--		TARGET.BD								= SOURCE.BD, 
	--		TARGET.MM								= SOURCE.MM, 
	--		TARGET.TW								= SOURCE.TW, 
	--		TARGET.TB								= SOURCE.TB, 
	--		TARGET.WS_RAC							= SOURCE.WS_RAC, 
	--		TARGET.AVAILABLE_TB						= SOURCE.AVAILABLE_TB, 
	--		TARGET.FS								= SOURCE.FS,
	--		TARGET.RL								= SOURCE.RL, 
	--		TARGET.RP								= SOURCE.RP, 
	--		TARGET.TN								= SOURCE.TN, 
	--		TARGET.AVAILABLE_FLEET					= SOURCE.AVAILABLE_FLEET, 
	--		TARGET.RT								= SOURCE.RT, 
	--		TARGET.SU								= SOURCE.SU, 
	--		TARGET.GOLD								= SOURCE.GOLD, 
	--		TARGET.PREDELIVERY						= SOURCE.PREDELIVERY, 
	--		TARGET.OVERDUE							= SOURCE.OVERDUE, 
	--		TARGET.ON_RENT							= SOURCE.ON_RENT,
	--		TARGET.[TOTAL_FLEET_MIN]				= SOURCE.[TOTAL_FLEET_MIN], 
	--		TARGET.[CARSALES_MIN]					= SOURCE.[CARSALES_MIN], 
	--		TARGET.[CARHOLD_H_MIN]					= SOURCE.[CARHOLD_H_MIN],	
	--		TARGET.[CARHOLD_L_MIN]					= SOURCE.[CARHOLD_L_MIN], 
	--		TARGET.[CU_MIN]							= SOURCE.[CU_MIN], 
	--		TARGET.[HA_MIN]							= SOURCE.[HA_MIN],  
	--		TARGET.[HL_MIN]							= SOURCE.[HL_MIN], 
	--		TARGET.[LL_MIN]							= SOURCE.[LL_MIN], 
	--		TARGET.[NC_MIN]							= SOURCE.[NC_MIN],  
	--		TARGET.[PL_MIN]							= SOURCE.[PL_MIN], 
	--		TARGET.[TC_MIN]							= SOURCE.[TC_MIN], 
	--		TARGET.[SV_MIN]							= SOURCE.[SV_MIN], 
	--		TARGET.[WS_MIN]							= SOURCE.[WS_MIN], 
	--		TARGET.[WS_NONRAC_MIN]					= SOURCE.[WS_NONRAC_MIN], 
	--		TARGET.[OPERATIONAL_FLEET_MIN]			= SOURCE.[OPERATIONAL_FLEET_MIN], 
	--		TARGET.[BD_MIN]							= SOURCE.[BD_MIN], 
	--		TARGET.[MM_MIN]							= SOURCE.[MM_MIN], 
	--		TARGET.[TW_MIN]							= SOURCE.[TW_MIN], 
	--		TARGET.[TB_MIN]							= SOURCE.[TB_MIN], 
	--		TARGET.[WS_RAC_MIN]						= SOURCE.[WS_RAC_MIN], 
	--		TARGET.[AVAILABLE_TB_MIN]				= SOURCE.[AVAILABLE_TB_MIN],
	--		TARGET.[FS_MIN]							= SOURCE.[FS_MIN], 
	--		TARGET.[RL_MIN]							= SOURCE.[RL_MIN], 
	--		TARGET.[RP_MIN]							= SOURCE.[RP_MIN], 
	--		TARGET.[TN_MIN]							= SOURCE.[TN_MIN],
	--		TARGET.[AVAILABLE_FLEET_MIN]			= SOURCE.[AVAILABLE_FLEET_MIN], 
	--		TARGET.[RT_MIN]							= SOURCE.[RT_MIN], 
	--		TARGET.[SU_MIN]							= SOURCE.[SU_MIN], 
	--		TARGET.[GOLD_MIN]						= SOURCE.[GOLD_MIN], 
	--		TARGET.[PREDELIVERY_MIN]				= SOURCE.[PREDELIVERY_MIN], 
	--		TARGET.[OVERDUE_MIN]					= SOURCE.[OVERDUE_MIN], 
	--		TARGET.[ON_RENT_MIN]					= SOURCE.[ON_RENT_MIN] ,
	--		TARGET.[TOTAL_FLEET_MAX]				= SOURCE.[TOTAL_FLEET_MAX] ,
	--		TARGET.[CARSALES_MAX]					= SOURCE.[CARSALES_MAX] , 
	--		TARGET.[CARHOLD_H_MAX]					= SOURCE.[CARHOLD_H_MAX] ,
	--		TARGET.[CARHOLD_L_MAX]					= SOURCE.[CARHOLD_L_MAX] ,
	--		TARGET.[CU_MAX]							= SOURCE.[CU_MAX] ,
	--		TARGET.[HA_MAX]							= SOURCE.[HA_MAX] , 
	--		TARGET.[HL_MAX]							= SOURCE.[HL_MAX] , 
	--		TARGET.[LL_MAX]							= SOURCE.[LL_MAX] , 
	--		TARGET.[NC_MAX]							= SOURCE.[NC_MAX] , 
	--		TARGET.[PL_MAX]							= SOURCE.[PL_MAX] , 
	--		TARGET.[TC_MAX]							= SOURCE.[TC_MAX] , 
	--		TARGET.[SV_MAX]							= SOURCE.[SV_MAX] , 
	--		TARGET.[WS_MAX]							= SOURCE.[WS_MAX] , 
	--		TARGET.[WS_NONRAC_MAX]					= SOURCE.[WS_NONRAC_MAX] ,
	--		TARGET.[OPERATIONAL_FLEET_MAX]			= SOURCE.[OPERATIONAL_FLEET_MAX] , 
	--		TARGET.[BD_MAX]							= SOURCE.[BD_MAX] , 
	--		TARGET.[MM_MAX]							= SOURCE.[MM_MAX] , 
	--		TARGET.[TW_MAX]							= SOURCE.[TW_MAX] , 
	--		TARGET.[TB_MAX]							= SOURCE.[TB_MAX] , 
	--		TARGET.[WS_RAC_MAX]						= SOURCE.[WS_RAC_MAX] , 
	--		TARGET.[AVAILABLE_TB_MAX]				= SOURCE.[AVAILABLE_TB_MAX] , 
	--		TARGET.[FS_MAX]							= SOURCE.[FS_MAX] , 
	--		TARGET.[RL_MAX]							= SOURCE.[RL_MAX] , 
	--		TARGET.[RP_MAX]							= SOURCE.[RP_MAX] , 
	--		TARGET.[TN_MAX]							= SOURCE.[TN_MAX] , 
	--		TARGET.[AVAILABLE_FLEET_MAX]			= SOURCE.[AVAILABLE_FLEET_MAX] , 
	--		TARGET.[RT_MAX]							= SOURCE.[RT_MAX] , 
	--		TARGET.[SU_MAX]							= SOURCE.[SU_MAX] , 
	--		TARGET.[GOLD_MAX]						= SOURCE.[GOLD_MAX] , 
	--		TARGET.[PREDELIVERY_MAX]				= SOURCE.[PREDELIVERY_MAX] , 
	--		TARGET.[OVERDUE_MAX]					= SOURCE.[OVERDUE_MAX] , 
	--		TARGET.[ON_RENT_MAX]					= SOURCE.[ON_RENT_MAX] , 
	--		TARGET.TOTAL_FLEET_MAX_ABSOLUTE			= SOURCE.TOTAL_FLEET_MAX_ABSOLUTE , 
	--		TARGET.OPERATIONAL_FLEET_MAX_ABSOLUTE	= SOURCE.OPERATIONAL_FLEET_MAX_ABSOLUTE , 
	--		TARGET.OVERDUE_MAX_ABSOLUTE				= SOURCE.OVERDUE_MAX_ABSOLUTE , 
	--		TARGET.ON_RENT_MAX_ABSOLUTE				= SOURCE.ON_RENT_MAX_ABSOLUTE 
			
			
	--WHEN NOT MATCHED THEN
	--	INSERT 
	--	(
	--		REP_YEAR, 
	--		REP_MONTH, 
	--		REP_WEEK_OF_YEAR, 
	--		REP_DAY_OF_WEEK, 
	--		REP_DATE, 
	--		COUNTRY, 
	--		LOCATION, 
	--		CAR_GROUP,
	--		FLEET_RAC_TTL , FLEET_RAC_OPS , FLEET_CARSALES , FLEET_LICENSEE , TOTAL_FLEET ,
	--		CARSALES , CARHOLD_H , CARHOLD_L , CU , HA , HL , LL , NC , PL , TC , 
	--		SV , WS, WS_NONRAC , OPERATIONAL_FLEET , BD , MM , TW , TB, 
	--		WS_RAC , AVAILABLE_TB , FS , RL , RP , TN , AVAILABLE_FLEET, 
	--		RT , SU , GOLD , PREDELIVERY , OVERDUE , ON_RENT ,
	--		[TOTAL_FLEET_MIN] , [CARSALES_MIN] , [CARHOLD_H_MIN],	
	--		[CARHOLD_L_MIN] , [CU_MIN] , [HA_MIN] , [HL_MIN] , [LL_MIN], 
	--		[NC_MIN] , [PL_MIN],  [TC_MIN] , [SV_MIN] , [WS_MIN], 
	--		[WS_NONRAC_MIN] , [OPERATIONAL_FLEET_MIN], 
	--		[BD_MIN] , [MM_MIN] , [TW_MIN] , [TB_MIN] , [WS_RAC_MIN], 
	--		[AVAILABLE_TB_MIN],
	--		[FS_MIN] , [RL_MIN] , [RP_MIN] , [TN_MIN] , [AVAILABLE_FLEET_MIN], 
	--		[RT_MIN] , [SU_MIN], 
	--		[GOLD_MIN] , [PREDELIVERY_MIN] , [OVERDUE_MIN] , [ON_RENT_MIN] , 
	--		[TOTAL_FLEET_MAX] ,
	--		[CARSALES_MAX] , 
	--		[CARHOLD_H_MAX] ,
	--		[CARHOLD_L_MAX] ,
	--		[CU_MAX] ,
	--		[HA_MAX] , 
	--		[HL_MAX] , 
	--		[LL_MAX] , 
	--		[NC_MAX] , 
	--		[PL_MAX] , 
	--		[TC_MAX] , 
	--		[SV_MAX] , 
	--		[WS_MAX] , 
	--		[WS_NONRAC_MAX] ,
	--		[OPERATIONAL_FLEET_MAX] , 
	--		[BD_MAX] , 
	--		[MM_MAX] , 
	--		[TW_MAX] , 
	--		[TB_MAX] , 
	--		[WS_RAC_MAX] , 
	--		[AVAILABLE_TB_MAX] , 
	--		[FS_MAX] , 
	--		[RL_MAX] , 
	--		[RP_MAX] , 
	--		[TN_MAX] , 
	--		[AVAILABLE_FLEET_MAX] , 
	--		[RT_MAX] , 
	--		[SU_MAX] , 
	--		[GOLD_MAX] , 
	--		[PREDELIVERY_MAX] , 
	--		[OVERDUE_MAX] , 
	--		[ON_RENT_MAX] , 
	--		TOTAL_FLEET_MAX_ABSOLUTE , 
	--		OPERATIONAL_FLEET_MAX_ABSOLUTE , 
	--		OVERDUE_MAX_ABSOLUTE , 
	--		ON_RENT_MAX_ABSOLUTE
	--	)
	--	VALUES 
	--	(
	--		SOURCE.REP_YEAR, 
	--		SOURCE.REP_MONTH, 
	--		SOURCE.REP_WEEK_OF_YEAR, 
	--		SOURCE.REP_DAY_OF_WEEK, 
	--		SOURCE.REP_DATE, 
	--		SOURCE.COUNTRY, 
	--		SOURCE.LOCATION, 
	--		SOURCE.CAR_GROUP,
	--		SOURCE.FLEET_RAC_TTL , SOURCE.FLEET_RAC_OPS , SOURCE.FLEET_CARSALES , 
	--		SOURCE.FLEET_LICENSEE , SOURCE.TOTAL_FLEET ,
	--		SOURCE.CARSALES , SOURCE.CARHOLD_H , SOURCE.CARHOLD_L , SOURCE.CU , SOURCE.HA , 
	--		SOURCE.HL , SOURCE.LL , SOURCE.NC , SOURCE.PL , SOURCE.TC , 
	--		SOURCE.SV, SOURCE.WS , SOURCE.WS_NONRAC , SOURCE.OPERATIONAL_FLEET, 
	--		SOURCE.BD , SOURCE.MM , SOURCE.TW , SOURCE.TB, 
	--		SOURCE.WS_RAC , SOURCE.AVAILABLE_TB , SOURCE.FS , SOURCE.RL, 
	--		SOURCE.RP , SOURCE.TN , SOURCE.AVAILABLE_FLEET , SOURCE.RT , SOURCE.SU, 
	--		SOURCE.GOLD , SOURCE.PREDELIVERY , SOURCE.OVERDUE , SOURCE.ON_RENT ,
	--		SOURCE.[TOTAL_FLEET_MIN], 
	--		SOURCE.[CARSALES_MIN] , SOURCE.[CARHOLD_H_MIN] ,	SOURCE.[CARHOLD_L_MIN], 
	--		SOURCE.[CU_MIN] , SOURCE.[HA_MIN] , SOURCE.[HL_MIN] , SOURCE.[LL_MIN], 
	--		SOURCE.[NC_MIN] , SOURCE.[PL_MIN] , SOURCE.[TC_MIN] , SOURCE.[SV_MIN], 
	--		SOURCE.[WS_MIN] , SOURCE.[WS_NONRAC_MIN] , SOURCE.[OPERATIONAL_FLEET_MIN], 
	--		SOURCE.[BD_MIN] , SOURCE.[MM_MIN] , SOURCE.[TW_MIN] , SOURCE.[TB_MIN], 
	--		SOURCE.[WS_RAC_MIN] , SOURCE.[AVAILABLE_TB_MIN],
	--		SOURCE.[FS_MIN] , SOURCE.[RL_MIN] , SOURCE.[RP_MIN] , SOURCE.[TN_MIN],
	--		SOURCE.[AVAILABLE_FLEET_MIN], 
	--		SOURCE.[RT_MIN] , SOURCE.[SU_MIN] , SOURCE.[GOLD_MIN], 
	--		SOURCE.[PREDELIVERY_MIN] , SOURCE.[OVERDUE_MIN] , SOURCE.[ON_RENT_MIN],
	--		SOURCE.[TOTAL_FLEET_MAX] ,
	--		SOURCE.[CARSALES_MAX] , 
	--		SOURCE.[CARHOLD_H_MAX] ,
	--		SOURCE.[CARHOLD_L_MAX] ,
	--		SOURCE.[CU_MAX] ,
	--		SOURCE.[HA_MAX] , 
	--		SOURCE.[HL_MAX] , 
	--		SOURCE.[LL_MAX] , 
	--		SOURCE.[NC_MAX] , 
	--		SOURCE.[PL_MAX] , 
	--		SOURCE.[TC_MAX] , 
	--		SOURCE.[SV_MAX] , 
	--		SOURCE.[WS_MAX] , 
	--		SOURCE.[WS_NONRAC_MAX] ,
	--		SOURCE.[OPERATIONAL_FLEET_MAX] , 
	--		SOURCE.[BD_MAX] , 
	--		SOURCE.[MM_MAX] , 
	--		SOURCE.[TW_MAX] , 
	--		SOURCE.[TB_MAX] , 
	--		SOURCE.[WS_RAC_MAX] , 
	--		SOURCE.[AVAILABLE_TB_MAX] , 
	--		SOURCE.[FS_MAX] , 
	--		SOURCE.[RL_MAX] , 
	--		SOURCE.[RP_MAX] , 
	--		SOURCE.[TN_MAX] , 
	--		SOURCE.[AVAILABLE_FLEET_MAX] , 
	--		SOURCE.[RT_MAX] , 
	--		SOURCE.[SU_MAX] , 
	--		SOURCE.[GOLD_MAX] , 
	--		SOURCE.[PREDELIVERY_MAX] , 
	--		SOURCE.[OVERDUE_MAX] , 
	--		SOURCE.[ON_RENT_MAX] , 
	--		SOURCE.TOTAL_FLEET_MAX_ABSOLUTE , 
	--		SOURCE.OPERATIONAL_FLEET_MAX_ABSOLUTE , 
	--		SOURCE.OVERDUE_MAX_ABSOLUTE , 
	--		SOURCE.ON_RENT_MAX_ABSOLUTE
	--	);

    
END