-- =============================================
-- Author:		Javier
-- Create date: June 2012
-- Description:	
-- =============================================
CREATE PROCEDURE [Import].[Update_Fleet_Actual]
@Type varchar(20)
	
AS
BEGIN
	
	SET NOCOUNT ON;

if @Type = 'Hourly'
begin
    UPDATE dbo.FLEET_EUROPE_ACTUAL SET
		BASEOP				= FEAQ.BASEOP,
		BDDAYS				= FEAQ.BDDAYS,
		CAPCOST				= FEAQ.CAPCOST,
		CAPDATE				= FEAQ.CAPDATE,
		CARHOLD1			= FEAQ.CARHOLD1,
		COLOR				= FEAQ.COLOR,
		DAYSAREA			= FEAQ.DAYSAREA,
		DAYSCTRY			= FEAQ.DAYSCTRY,
		DAYSMOVE			= FEAQ.DAYSMOVE,
		DAYSREV				= FEAQ.DAYSREV,
		DEPAMT				= FEAQ.DEPAMT,
		DEPSTAT				= FEAQ.DEPSTAT,
		DRVNAME				= FEAQ.DRVNAME,
		DUEAREA				= FEAQ.DUEAREA,
		DUEDATE				= FEAQ.DUEDATE,
		DUETIME				= FEAQ.DUETIME,
		DUEWWD				= FEAQ.DUEWWD,
		IDATE				= FEAQ.IDATE,
		LICENSE				= FEAQ.LICENSE,
		LSTAREA				= FEAQ.LSTAREA,
		LSTDATE				= FEAQ.LSTDATE,
		LSTMLG				= FEAQ.LSTMLG,
		LSTNO				= FEAQ.LSTNO,
		LSTOORC				= FEAQ.LSTOORC,
		LSTTIME				= FEAQ.LSTTIME,
		LSTTYPE				= FEAQ.LSTTYPE,
		LSTWWD				= FEAQ.LSTWWD,
		MMDAYS				= FEAQ.MMDAYS,
		MODDESC				= FEAQ.MODDESC,
		MODEL				= FEAQ.MODEL,
		MODGROUP			= FEAQ.MODGROUP,
		MOVETYPE			= FEAQ.MOVETYPE,
		MSODATE				= FEAQ.MSODATE,
		OPERDAYS			= FEAQ.OPERDAYS,
		OPERSTAT			= FEAQ.OPERSTAT,
		OWNAREA				= FEAQ.OWNAREA,
		OWNWWD				= FEAQ.OWNWWD,
		PONO				= FEAQ.PONO,
		PREVWWD				= FEAQ.PREVWWD,
		RADATE				= FEAQ.RADATE,
		RALOC				= FEAQ.RALOC,
		RC					= FEAQ.RC,
		SDATE				= FEAQ.SDATE,
		SPROCDAT			= FEAQ.SPROCDAT,
		TERMDAYS			= FEAQ.TERMDAYS,
		UNIT				= FEAQ.UNIT,
		VC					= FEAQ.VC,
		VEHCLAS				= FEAQ.VEHCLAS,
		VEHTYPE				= FEAQ.VEHTYPE,
		VENDNBR				= FEAQ.VENDNBR,
		VISMODEL			= FEAQ.VISMODEL,
		COUNTRY				= FEAQ.COUNTRY,
		[POOL]				= FEAQ.[POOL],
		LOC_GROUP			= FEAQ.LOC_GROUP,
		CARVAN				= FEAQ.CARVAN,
		CAR_CLASS			= FEAQ.CAR_CLASS,
		FLEET_RAC_TTL		= FEAQ.FLEET_RAC_TTL,
		FLEET_RAC_OPS		= FEAQ.FLEET_RAC_OPS,
		FLEET_CARSALES		= FEAQ.FLEET_CARSALES,
		FLEET_LICENSEE		= FEAQ.FLEET_LICENSEE,
		TOTAL_FLEET			= FEAQ.TOTAL_FLEET,
		CARSALES			= FEAQ.CARSALES,
		CARHOLD_H			= FEAQ.CARHOLD_H,
		CARHOLD_L			= FEAQ.CARHOLD_L,
		CU					= FEAQ.CU,
		HA					= FEAQ.HA,
		HL					= FEAQ.HL,
		LL					= FEAQ.LL,
		NC					= FEAQ.NC,
		PL					= FEAQ.PL,
		TC					= FEAQ.TC,
		SV					= FEAQ.SV,
		WS					= FEAQ.WS,
		WS_NONRAC			= FEAQ.WS_NONRAC,
		OPERATIONAL_FLEET	= FEAQ.OPERATIONAL_FLEET,
		BD					= FEAQ.BD,
		MM					= FEAQ.MM,
		TW					= FEAQ.TW,
		TB					= FEAQ.TB,
		WS_RAC				= FEAQ.WS_RAC,
		AVAILABLE_TB		= FEAQ.AVAILABLE_TB,
		FS					= FEAQ.FS,
		RL					= FEAQ.RL,
		RP					= FEAQ.RP,
		TN					= FEAQ.TN,
		AVAILABLE_FLEET		= FEAQ.AVAILABLE_FLEET,
		RT					= FEAQ.RT,
		SU					= FEAQ.SU,
		GOLD				= FEAQ.GOLD,
		PREDELIVERY			= FEAQ.PREDELIVERY,
		OVERDUE				= FEAQ.OVERDUE,
		ON_RENT				= FEAQ.ON_RENT,
		CI_HOURS			= FEAQ.CI_HOURS,
		CI_HOURS_OFFSET		= FEAQ.CI_HOURS_OFFSET,
		CI_DAYS				= FEAQ.CI_DAYS
		FROM
		(
			SELECT 
				FEA.BASEOP,
				FEA.BDDAYS,
				FEA.CAPCOST,
				FEA.CAPDATE,
				FEA.CARHOLD1,
				FEA.COLOR,
				FEA.DAYSAREA,
				FEA.DAYSCTRY,
				FEA.DAYSMOVE,
				FEA.DAYSREV,
				FEA.DEPAMT,
				FEA.DEPSTAT,
				FEA.DRVNAME,
				FEA.DUEAREA,
				FEA.DUEDATE,
				FEA.DUETIME,
				FEA.DUEWWD,
				FEA.IDATE,
				FEA.LICENSE,
				FEA.LSTAREA,
				FEA.LSTDATE,
				FEA.LSTMLG,
				FEA.LSTNO,
				FEA.LSTOORC,
				FEA.LSTTIME,
				FEA.LSTTYPE,
				FEA.LSTWWD,
				FEA.MMDAYS,
				FEA.MODDESC,
				FEA.MODEL,
				FEA.MODGROUP,
				FEA.MOVETYPE,
				FEA.MSODATE,
				FEA.OPERDAYS,
				FEA.OPERSTAT,
				FEA.OWNAREA,
				FEA.OWNWWD,
				FEA.PONO,
				FEA.PREVWWD,
				FEA.RADATE,
				FEA.RALOC,
				FEA.RC,
				FEA.SDATE,
				FEA.SPROCDAT,
				FEA.TERMDAYS,
				FEA.UNIT,
				FEA.VC,
				FEA.VEHCLAS,
				FEA.VEHTYPE,
				FEA.VENDNBR,
				FEA.VISMODEL,
				FEA.COUNTRY,
				FEA.[POOL],
				FEA.LOC_GROUP ,
				FEA.CARVAN,
				FEA.CAR_CLASS,
				FEA.FLEET_RAC_TTL,
				FEA.FLEET_RAC_OPS,
				FEA.FLEET_CARSALES,
				FEA.FLEET_LICENSEE,
				FEA.TOTAL_FLEET,
				FEA.CARSALES,
				FEA.CARHOLD_H ,
				FEA.CARHOLD_L,
				FEA.CU ,
				FEA.HA,
				FEA.HL,
				FEA.LL,
				FEA.NC,
				FEA.PL,
				FEA.TC,
				FEA.SV,
				FEA.WS,
				FEA.WS_NONRAC,
				FEA.OPERATIONAL_FLEET ,
				FEA.BD,
				FEA.MM,
				FEA.TW,
				FEA.TB,
				FEA.WS_RAC,
				FEA.AVAILABLE_TB,
				FEA.FS,
				FEA.RL,
				FEA.RP,
				FEA.TN,
				FEA.AVAILABLE_FLEET,
				FEA.RT,
				FEA.SU,
				FEA.GOLD ,
				FEA.PREDELIVERY ,
				FEA.OVERDUE ,
				FEA.ON_RENT ,
				FEA.CI_HOURS ,
				FEA.CI_HOURS_OFFSET,
				FEA.CI_DAYS,
				FEA.SERIAL
				FROM 
					dbo.FLEET_EUROPE_ACTUAL_QUERY_TABLE FEA
				INNER JOIN DBO.FLEET_EUROPE_OKCFILE AS OKC ON 
					OKC.SERIAL = FEA.SERIAL 
				AND
					OKC.OWNAREA =FEA.OWNAREA 
		) AS FEAQ
		WHERE
			FEAQ.SERIAL		= dbo.FLEET_EUROPE_ACTUAL.SERIAL 
		AND
			FEAQ.OWNAREA	= dbo.FLEET_EUROPE_ACTUAL.OWNAREA 
			
			
			
		UPDATE [dbo].FLEET_EUROPE_ACTUAL  SET TOTAL_FLEET = 0 WHERE OPERSTAT = 'UNK'

		exec PopulateVehicleTableFromFea
			
end			
END